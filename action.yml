name: Run Visual Basic 6.0 build
description: Run vb.exe make for specified VB project
inputs:
  vbpprojectpath:
    description: path to visual basic project (*.vbp)
    required: true
  outdir:
    description: output path for build output
    required: false
    default: '.'
runs: 
  using: 'composite'
  steps:
    - name: Compile vbp file
      shell: pwsh
      run: |
        $currentdir = pwd
        $vbpprojectpath = "${{ inputs.vbpprojectpath }}"
        $outputdir = "${{ inputs.outputdir }}"
        Write-Output "Current dir is $currentdir"
        Write-Output "Visual Basic project path is $vbpprojectpath"
        Write-Output "Output directory is $outputdir"
        & $env:GITHUB_ACTION_PATH/run_vb6_build.ps1 $vbpprojectpath $outputdir $env.GITHUB_OUTPUT
        Write-Output "The command is: $($MyInvocation.Line)"
        echo "{name}={buildstatus}" >> $GITHUB_OUTPUT
